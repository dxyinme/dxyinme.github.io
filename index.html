<!DOCTYPE html>
<html lang="zh-CN">
<head>
  <meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=2">
<meta name="theme-color" content="#222">
<meta name="generator" content="Hexo 5.4.0">
  <link rel="apple-touch-icon" sizes="180x180" href="/images/apple-touch-icon-next.png">
  <link rel="icon" type="image/png" sizes="32x32" href="/images/favicon-32x32-next.png">
  <link rel="icon" type="image/png" sizes="16x16" href="/images/favicon-16x16-next.png">
  <link rel="mask-icon" href="/images/logo.svg" color="#222">

<link rel="stylesheet" href="/css/main.css">


<link rel="stylesheet" href="/lib/font-awesome/css/all.min.css">

<script id="hexo-configurations">
    var NexT = window.NexT || {};
    var CONFIG = {"hostname":"example.com","root":"/","scheme":"Muse","version":"7.8.0","exturl":false,"sidebar":{"position":"left","display":"post","padding":18,"offset":12,"onmobile":false},"copycode":{"enable":false,"show_result":false,"style":null},"back2top":{"enable":true,"sidebar":false,"scrollpercent":false},"bookmark":{"enable":false,"color":"#222","save":"auto"},"fancybox":false,"mediumzoom":false,"lazyload":false,"pangu":false,"comments":{"style":"tabs","active":null,"storage":true,"lazyload":false,"nav":null},"algolia":{"hits":{"per_page":10},"labels":{"input_placeholder":"Search for Posts","hits_empty":"We didn't find any results for the search: ${query}","hits_stats":"${hits} results found in ${time} ms"}},"localsearch":{"enable":false,"trigger":"auto","top_n_per_article":1,"unescape":false,"preload":false},"motion":{"enable":true,"async":false,"transition":{"post_block":"fadeIn","post_header":"slideDownIn","post_body":"slideDownIn","coll_header":"slideLeftIn","sidebar":"slideUpIn"}}};
  </script>

  <meta name="description" content="可怜人的自我救赎">
<meta property="og:type" content="website">
<meta property="og:title" content="dxy的耻辱柱">
<meta property="og:url" content="http://example.com/index.html">
<meta property="og:site_name" content="dxy的耻辱柱">
<meta property="og:description" content="可怜人的自我救赎">
<meta property="og:locale" content="zh_CN">
<meta property="article:author" content="dxyinme">
<meta name="twitter:card" content="summary">

<link rel="canonical" href="http://example.com/">


<script id="page-configurations">
  // https://hexo.io/docs/variables.html
  CONFIG.page = {
    sidebar: "",
    isHome : true,
    isPost : false,
    lang   : 'zh-CN'
  };
</script>

  <title>dxy的耻辱柱</title>
  






  <noscript>
  <style>
  .use-motion .brand,
  .use-motion .menu-item,
  .sidebar-inner,
  .use-motion .post-block,
  .use-motion .pagination,
  .use-motion .comments,
  .use-motion .post-header,
  .use-motion .post-body,
  .use-motion .collection-header { opacity: initial; }

  .use-motion .site-title,
  .use-motion .site-subtitle {
    opacity: initial;
    top: initial;
  }

  .use-motion .logo-line-before i { left: initial; }
  .use-motion .logo-line-after i { right: initial; }
  </style>
</noscript>

</head>

<body itemscope itemtype="http://schema.org/WebPage">
  <div class="container use-motion">
    <div class="headband"></div>

    <header class="header" itemscope itemtype="http://schema.org/WPHeader">
      <div class="header-inner"><div class="site-brand-container">
  <div class="site-nav-toggle">
    <div class="toggle" aria-label="切换导航栏">
      <span class="toggle-line toggle-line-first"></span>
      <span class="toggle-line toggle-line-middle"></span>
      <span class="toggle-line toggle-line-last"></span>
    </div>
  </div>

  <div class="site-meta">

    <a href="/" class="brand" rel="start">
      <span class="logo-line-before"><i></i></span>
      <h1 class="site-title">dxy的耻辱柱</h1>
      <span class="logo-line-after"><i></i></span>
    </a>
  </div>

  <div class="site-nav-right">
    <div class="toggle popup-trigger">
    </div>
  </div>
</div>




<nav class="site-nav">
  <ul id="menu" class="main-menu menu">
        <li class="menu-item menu-item-home">

    <a href="/" rel="section"><i class="fa fa-home fa-fw"></i>首页</a>

  </li>
        <li class="menu-item menu-item-about">

    <a href="/about/" rel="section"><i class="fa fa-user fa-fw"></i>关于</a>

  </li>
        <li class="menu-item menu-item-tags">

    <a href="/tags/" rel="section"><i class="fa fa-tags fa-fw"></i>标签</a>

  </li>
        <li class="menu-item menu-item-categories">

    <a href="/categories/" rel="section"><i class="fa fa-th fa-fw"></i>分类</a>

  </li>
        <li class="menu-item menu-item-friends">

    <a href="/friends/" rel="section"><i class="fa fa fa-user fa-fw"></i>friends</a>

  </li>
        <li class="menu-item menu-item-archives">

    <a href="/archives/" rel="section"><i class="fa fa-archive fa-fw"></i>归档</a>

  </li>
  </ul>
</nav>




</div>
    </header>

    
  <div class="back-to-top">
    <i class="fa fa-arrow-up"></i>
    <span>0%</span>
  </div>


    <main class="main">
      <div class="main-inner">
        <div class="content-wrap">
          

          <div class="content index posts-expand">
            
      
  
  
  <article itemscope itemtype="http://schema.org/Article" class="post-block" lang="zh-CN">
    <link itemprop="mainEntityOfPage" href="http://example.com/2022/10/29/%E6%8A%80%E6%9C%AF%E7%9B%B8%E5%85%B3/%E4%B8%80%E4%BA%9Bgrpc%E7%9B%B8%E5%85%B3%E7%9A%84%E6%B3%A8%E6%84%8F%E4%BA%8B%E9%A1%B9/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/avatar.gif">
      <meta itemprop="name" content="dxyinme">
      <meta itemprop="description" content="可怜人的自我救赎">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="dxy的耻辱柱">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          
            <a href="/2022/10/29/%E6%8A%80%E6%9C%AF%E7%9B%B8%E5%85%B3/%E4%B8%80%E4%BA%9Bgrpc%E7%9B%B8%E5%85%B3%E7%9A%84%E6%B3%A8%E6%84%8F%E4%BA%8B%E9%A1%B9/" class="post-title-link" itemprop="url">一些grpc相关的注意事项</a>
        </h2>

        <div class="post-meta">
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-calendar"></i>
              </span>
              <span class="post-meta-item-text">发表于</span>
              

              <time title="创建时间：2022-10-29 10:00:01 / 修改时间：10:00:28" itemprop="dateCreated datePublished" datetime="2022-10-29T10:00:01+08:00">2022-10-29</time>
            </span>

          

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">

      
          <h1 id="写在前面"><a href="#写在前面" class="headerlink" title="写在前面"></a>写在前面</h1><p>最近闲来无事，想要搞一个个人的cpp开发脚手架，项目地址在<a target="_blank" rel="noopener" href="https://github.com/dxyinme/ezlib">这里</a>，欢迎大家参与。<br>在这个项目里面我遇到了一些跟grpc相关的问题，刚好想要总结一下，就写写个blog记录一下好了。</p>
<h1 id="http-https-proxy"><a href="#http-https-proxy" class="headerlink" title="http/https-proxy"></a>http/https-proxy</h1><p>如果你的机器开着代理，请务必给grpc使用的host配置NO_PROXY，如下：</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">NO_PROXY=localhost,127.0.0.0/8,::1,grpc.test.com</span><br></pre></td></tr></table></figure>
<p>否则可能会出现发包或者回包失败的情况。当然这也有可能是我的代理的问题</p>

      
    </div>

    
    
    
      <footer class="post-footer">
        <div class="post-eof"></div>
      </footer>
  </article>
  
  
  

      
  
  
  <article itemscope itemtype="http://schema.org/Article" class="post-block" lang="zh-CN">
    <link itemprop="mainEntityOfPage" href="http://example.com/2022/07/24/%E7%AE%97%E6%B3%95%E9%A2%98/%E7%BB%83%E6%89%8B-%E5%8A%A8%E6%80%81%E8%A7%84%E5%88%92/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/avatar.gif">
      <meta itemprop="name" content="dxyinme">
      <meta itemprop="description" content="可怜人的自我救赎">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="dxy的耻辱柱">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          
            <a href="/2022/07/24/%E7%AE%97%E6%B3%95%E9%A2%98/%E7%BB%83%E6%89%8B-%E5%8A%A8%E6%80%81%E8%A7%84%E5%88%92/" class="post-title-link" itemprop="url">练手-动态规划</a>
        </h2>

        <div class="post-meta">
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-calendar"></i>
              </span>
              <span class="post-meta-item-text">发表于</span>
              

              <time title="创建时间：2022-07-24 18:59:15 / 修改时间：19:58:53" itemprop="dateCreated datePublished" datetime="2022-07-24T18:59:15+08:00">2022-07-24</time>
            </span>

          

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">

      
          <h2 id="景区路线规划"><a href="#景区路线规划" class="headerlink" title="景区路线规划"></a>景区路线规划</h2><p><a target="_blank" rel="noopener" href="https://ac.nowcoder.com/acm/problem/13250">来源</a><br><a href="/download/code/algo/dp/%E6%99%AF%E5%8C%BA%E8%B7%AF%E7%BA%BF%E8%A7%84%E5%88%92-acnowcoder-13250.cpp">代码</a></p>
<h3 id="题解"><a href="#题解" class="headerlink" title="题解"></a>题解</h3><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">把男生女生分开看</span><br><span class="line">f[<span class="number">0</span>/<span class="number">1</span>][i][j]表示 男生/女生 到达i点后，还有j的时间，可以获得的最大快乐值期望。</span><br><span class="line">然后就可以记忆化搜索了</span><br></pre></td></tr></table></figure>

<h2 id="黑白树"><a href="#黑白树" class="headerlink" title="黑白树"></a>黑白树</h2><p><a target="_blank" rel="noopener" href="https://ac.nowcoder.com/acm/problem/13249">来源</a><br><a href="/download/code/algo/dp/%E9%BB%91%E7%99%BD%E6%A0%91-acnowcoder-13134.cpp">代码</a></p>
<h3 id="题解-1"><a href="#题解-1" class="headerlink" title="题解"></a>题解</h3><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">f[i]表示这个节点最多能往上延伸多少步（包括i这个节点）</span><br><span class="line">k[i] = <span class="built_in">max</span>(k[i], k[son] - <span class="number">1</span>);</span><br><span class="line">f[i] = <span class="built_in">max</span>(f[i], f[son] - <span class="number">1</span>);</span><br><span class="line">如果此算法算出的f[i] == <span class="number">0</span>，则f[i] = k[i]，这个点必须操作</span><br></pre></td></tr></table></figure>

<h2 id="牛牛的数列"><a href="#牛牛的数列" class="headerlink" title="牛牛的数列"></a>牛牛的数列</h2><p><a target="_blank" rel="noopener" href="https://ac.nowcoder.com/acm/problem/13134">来源</a><br><a href="/download/code/algo/dp/%E7%89%9B%E7%89%9B%E7%9A%84%E6%95%B0%E5%88%97-acnowcoder-13134.cpp">代码</a></p>
<h3 id="题解-2"><a href="#题解-2" class="headerlink" title="题解"></a>题解</h3><p>序列DP,题目描述不清楚，记住是<strong>连续</strong>子序列，就是子串，刚开始按照不连续的去做了。</p>
<figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">f[i][<span class="number">0</span>] 表示 以 i 结尾的最长子串</span><br><span class="line">f[i][<span class="number">1</span>] 表示 以 i 开头的最长子串</span><br><span class="line">然后枚举 i , 判断是否可以有中间值</span><br><span class="line">注意边界条件（i做新子串的开头 <span class="keyword">or</span> 结尾）</span><br></pre></td></tr></table></figure>
      
    </div>

    
    
    
      <footer class="post-footer">
        <div class="post-eof"></div>
      </footer>
  </article>
  
  
  

      
  
  
  <article itemscope itemtype="http://schema.org/Article" class="post-block" lang="zh-CN">
    <link itemprop="mainEntityOfPage" href="http://example.com/2021/11/07/%E6%8A%80%E6%9C%AF%E7%9B%B8%E5%85%B3/%E6%80%8E%E6%A0%B7%E5%AE%9E%E7%8E%B0%E4%B8%80%E4%B8%AA%E7%BA%BF%E7%A8%8B%E6%B1%A0/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/avatar.gif">
      <meta itemprop="name" content="dxyinme">
      <meta itemprop="description" content="可怜人的自我救赎">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="dxy的耻辱柱">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          
            <a href="/2021/11/07/%E6%8A%80%E6%9C%AF%E7%9B%B8%E5%85%B3/%E6%80%8E%E6%A0%B7%E5%AE%9E%E7%8E%B0%E4%B8%80%E4%B8%AA%E7%BA%BF%E7%A8%8B%E6%B1%A0/" class="post-title-link" itemprop="url">怎样实现一个线程池</a>
        </h2>

        <div class="post-meta">
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-calendar"></i>
              </span>
              <span class="post-meta-item-text">发表于</span>

              <time title="创建时间：2021-11-07 19:58:29" itemprop="dateCreated datePublished" datetime="2021-11-07T19:58:29+08:00">2021-11-07</time>
            </span>
              <span class="post-meta-item">
                <span class="post-meta-item-icon">
                  <i class="far fa-calendar-check"></i>
                </span>
                <span class="post-meta-item-text">更新于</span>
                <time title="修改时间：2022-07-23 14:51:46" itemprop="dateModified" datetime="2022-07-23T14:51:46+08:00">2022-07-23</time>
              </span>

          

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">

      
          <h1 id="摘要"><a href="#摘要" class="headerlink" title="摘要"></a>摘要</h1><p>本文主要整理了一下如何使用C++14编写一个属于自己的线程池。<br>详细代码位于 <a target="_blank" rel="noopener" href="https://github.com/dxyinme/ezlib/tree/main/thread/threadpool">https://github.com/dxyinme/ezlib/tree/main/thread/threadpool</a> </p>
<h1 id="一些介绍"><a href="#一些介绍" class="headerlink" title="一些介绍"></a>一些介绍</h1><p>虽然现在协程在很多情况下已经成为了后台开发的一个主流选择，但是线程以及线程池在整个后台开发的流程中依然很常见。这里介绍一个简单的线程池的使用以及设计编写方法。</p>
<h1 id="设计"><a href="#设计" class="headerlink" title="设计"></a>设计</h1><h2 id="任务"><a href="#任务" class="headerlink" title="任务"></a>任务</h2><p>我们首先需要一个对任务的定义。一个线程池的作用就是为了并发的去执行一系列不相关的任务的。所以我们定义了如下任务</p>
<figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">ThTask</span> &#123;</span></span><br><span class="line"><span class="keyword">public</span>:</span><br><span class="line">  <span class="built_in">ThTask</span>();</span><br><span class="line">  <span class="built_in">ThTask</span>(<span class="keyword">int</span> task_id);</span><br><span class="line">  <span class="function"><span class="keyword">void</span> <span class="title">Done</span><span class="params">()</span></span>; <span class="comment">// 做完任务之后执行一下Done</span></span><br><span class="line">  <span class="function"><span class="keyword">void</span> <span class="title">Wait</span><span class="params">()</span></span>; <span class="comment">// Wait()直到任务做完</span></span><br><span class="line">  <span class="function"><span class="keyword">virtual</span> <span class="keyword">void</span> <span class="title">TaskDo</span><span class="params">()</span> </span>= <span class="number">0</span>; <span class="comment">// 具体任务</span></span><br><span class="line">  ~<span class="built_in">ThTask</span>() = <span class="keyword">default</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">private</span>:</span><br><span class="line">  std::condition_variable cv_;</span><br><span class="line">  std::mutex mtx_;</span><br><span class="line">  <span class="keyword">bool</span> is_done_;</span><br><span class="line">  <span class="keyword">int</span> task_id_;</span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure>
<p>对于具体的一个任务，我们只需要用一个新的Task类，继承ThTask，实现TaskDo这个函数就可以。而且我们可以利用condition_variable的特性，使得主线程在Wait的时候挂起，直到这个task结束的时候才被唤醒。</p>
<p>上述功能的实现方式如下：</p>
<figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">ThTask::Wait</span><span class="params">()</span> </span>&#123;</span><br><span class="line">  std::unique_lock&lt;std::mutex&gt;_(mtx_); <span class="comment">// 需要有一个互斥锁</span></span><br><span class="line">  cv_.<span class="built_in">wait</span>(_, [&amp;]&#123; <span class="keyword">return</span> is_done_; &#125;); <span class="comment">// 这里会在Wait函数被调用的线程被唤醒的时候做判断，如果lambda函数的结果是false，则继续挂起，否则结束</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h2 id="线程池"><a href="#线程池" class="headerlink" title="线程池"></a>线程池</h2><p>线程池可以被看成是若干个互不相关的线程，每个线程会定时去获取任务，这是使用触发式的任务启动。<br>具体实现方式建下面的代码。</p>
<figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">for</span> (;;) &#123;</span><br><span class="line">  std::shared_ptr&lt;ThTask&gt; t_ptr;</span><br><span class="line">  &#123;</span><br><span class="line">    std::unique_lock&lt;std::mutex&gt; _(q_mtx_);</span><br><span class="line">    cv_.<span class="built_in">wait</span>(_, [&amp;] &#123; <span class="keyword">return</span> is_done_ || !task_queue_.<span class="built_in">empty</span>();&#125;); <span class="comment">// 这里如果取不到任务就会直接阻塞，让其他线程先执行，直到下一次被唤醒。</span></span><br><span class="line">    <span class="keyword">if</span> (is_done_) &#123;</span><br><span class="line">      <span class="keyword">break</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    t_ptr = task_queue_.<span class="built_in">front</span>();</span><br><span class="line">    task_queue_.<span class="built_in">pop</span>();</span><br><span class="line">  &#125;</span><br><span class="line">  t_ptr-&gt;<span class="built_in">SetBeginTime</span>();</span><br><span class="line">  t_ptr-&gt;<span class="built_in">TaskDo</span>();</span><br><span class="line">  t_ptr-&gt;<span class="built_in">Done</span>();</span><br><span class="line">  t_ptr-&gt;<span class="built_in">SetFinishTime</span>();</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>同样的，只有在commit任务的时候才会触发线程池取任务。为了防止多个线程产生任务争强的情况，每次commit的时候只唤醒一个线程。</p>
<figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">ThPool::Commit</span><span class="params">(std::shared_ptr&lt;ThTask&gt; task_ptr)</span> </span>&#123;</span><br><span class="line">  task_ptr-&gt;<span class="built_in">SetCommitTime</span>();</span><br><span class="line">  task_queue_.<span class="built_in">push</span>(std::<span class="built_in">move</span>(task_ptr));</span><br><span class="line">  cv_.<span class="built_in">notify_one</span>();</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h1 id="总结"><a href="#总结" class="headerlink" title="总结"></a>总结</h1><p>这里是一个对线程池的简单介绍和一种实现，当然也有其他的实现方式，TODO学习中。</p>

      
    </div>

    
    
    
      <footer class="post-footer">
        <div class="post-eof"></div>
      </footer>
  </article>
  
  
  

      
  
  
  <article itemscope itemtype="http://schema.org/Article" class="post-block" lang="zh-CN">
    <link itemprop="mainEntityOfPage" href="http://example.com/2021/11/06/%E7%AE%97%E6%B3%95%E9%A2%98/Integers-On-Grid/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/avatar.gif">
      <meta itemprop="name" content="dxyinme">
      <meta itemprop="description" content="可怜人的自我救赎">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="dxy的耻辱柱">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          
            <a href="/2021/11/06/%E7%AE%97%E6%B3%95%E9%A2%98/Integers-On-Grid/" class="post-title-link" itemprop="url">Integers On Grid</a>
        </h2>

        <div class="post-meta">
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-calendar"></i>
              </span>
              <span class="post-meta-item-text">发表于</span>
              

              <time title="创建时间：2021-11-06 21:56:34 / 修改时间：22:37:49" itemprop="dateCreated datePublished" datetime="2021-11-06T21:56:34+08:00">2021-11-06</time>
            </span>

          

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">

      
          <h1 id="来源"><a href="#来源" class="headerlink" title="来源"></a>来源</h1><p><a target="_blank" rel="noopener" href="https://atcoder.jp/contests/abc224/tasks/abc224_e">ABC224E</a><br>一道atcoder的图论题</p>
<h1 id="题意"><a href="#题意" class="headerlink" title="题意"></a>题意</h1><p>给你一个<code>H * W</code>的方格矩形，其中有<code>N</code>个格子有正整数，其他的格子数字都是<code>0</code>, 每个有正整数的格子上面都有一块木板，你可以让一个木板从一个方格<code>A</code>，传送到另一个方格<code>B</code>，但是要遵循下列条件：</p>
<ol>
<li><code>B</code>的数字严格大于<code>A</code>的数字</li>
<li><code>B</code>和<code>A</code>在同一行或者同一列</li>
</ol>
<p>对于每个木板，输出它最多能传送多少次</p>
<h1 id="题解"><a href="#题解" class="headerlink" title="题解"></a>题解</h1><p>看到这个我们很容易就可以想到反向建图之后，跑拓扑排序。对于每行每列按照非<code>0</code>格子的数字从大到小，对编号进行排序，每个点对所有数字小于自己中，数字最大的点建边，但是这样可能会出现<code>N * N</code>级别的边。所以在每个数字相同的点集合之间建边需要一个特殊的点，拓扑排序记录每个点是第几层，最后除以<code>2</code>就可以（去掉特殊点对距离的影响）。</p>
<figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;bits/stdc++.h&gt;</span></span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> std;</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> <span class="keyword">int</span> MAXN = <span class="number">2e5</span> + <span class="number">4</span>;</span><br><span class="line"></span><br><span class="line">vector&lt;<span class="keyword">int</span>&gt; ro[MAXN], co[MAXN];</span><br><span class="line"><span class="class"><span class="keyword">struct</span> <span class="title">Pot</span> &#123;</span> <span class="keyword">int</span> x, y, a; &#125; p[MAXN];</span><br><span class="line"><span class="keyword">int</span> h,w,n, cn;</span><br><span class="line"><span class="keyword">int</span> ans[MAXN * <span class="number">4</span>];</span><br><span class="line"><span class="keyword">int</span> du[MAXN * <span class="number">4</span>];</span><br><span class="line">vector&lt;vector&lt;<span class="keyword">int</span>&gt;&gt; G;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">inline</span> <span class="keyword">bool</span> <span class="title">Cmp</span><span class="params">(<span class="keyword">const</span> <span class="keyword">int</span> &amp; x, <span class="keyword">const</span> <span class="keyword">int</span> &amp; y)</span> </span>&#123;</span><br><span class="line">  <span class="keyword">return</span> p[x].a &lt; p[y].a;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">build</span><span class="params">(vector&lt;<span class="keyword">int</span>&gt;&amp; o)</span> </span>&#123;</span><br><span class="line">  <span class="built_in">sort</span>(o.<span class="built_in">begin</span>(), o.<span class="built_in">end</span>(), Cmp);</span><br><span class="line">  <span class="keyword">int</span> l = <span class="number">0</span>, r = <span class="number">0</span>;</span><br><span class="line">  <span class="keyword">int</span> lastp = <span class="number">-1</span>;</span><br><span class="line">  <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span>; i &lt; o.<span class="built_in">size</span>(); i++) &#123;</span><br><span class="line">    <span class="keyword">if</span> (p[o[i]].a == p[o[i<span class="number">-1</span>]].a) &#123;</span><br><span class="line">      r ++;</span><br><span class="line">      <span class="keyword">if</span> (lastp != <span class="number">-1</span>) &#123;</span><br><span class="line">        G[o[i]].<span class="built_in">push_back</span>(lastp);</span><br><span class="line">        du[lastp] ++;</span><br><span class="line">      &#125;</span><br><span class="line">    &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">      lastp = ++cn;</span><br><span class="line">      <span class="keyword">for</span> (<span class="keyword">int</span> j = l; j &lt;= r; j++) &#123;</span><br><span class="line">        G[lastp].<span class="built_in">push_back</span>(o[j]);</span><br><span class="line">        du[o[j]] ++;</span><br><span class="line">      &#125;</span><br><span class="line">      l = r = i;</span><br><span class="line">      G[o[i]].<span class="built_in">push_back</span>(lastp);</span><br><span class="line">      du[lastp] ++;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span> </span>&#123;</span><br><span class="line">  <span class="built_in">scanf</span>(<span class="string">&quot;%d%d%d&quot;</span>,&amp;h,&amp;w,&amp;n);</span><br><span class="line">  G.<span class="built_in">resize</span>(n * <span class="number">4</span> + <span class="number">5</span>);</span><br><span class="line">  cn = n;</span><br><span class="line">  <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span>; i &lt;= n; i++) &#123;</span><br><span class="line">    <span class="built_in">scanf</span>(<span class="string">&quot;%d%d%d&quot;</span>,&amp;p[i].x,&amp;p[i].y,&amp;p[i].a);</span><br><span class="line">    ro[p[i].x].<span class="built_in">push_back</span>(i);</span><br><span class="line">    co[p[i].y].<span class="built_in">push_back</span>(i);</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; MAXN; i++) &#123;</span><br><span class="line">    <span class="keyword">if</span> (!ro[i].<span class="built_in">empty</span>()) &#123;</span><br><span class="line">      <span class="built_in">build</span>(ro[i]); </span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">if</span> (!co[i].<span class="built_in">empty</span>()) &#123;</span><br><span class="line">      <span class="built_in">build</span>(co[i]);  </span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line">  queue&lt;<span class="keyword">int</span>&gt;q;</span><br><span class="line">  <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span>; i &lt;= n; i++) &#123;</span><br><span class="line">    <span class="keyword">if</span> (du[i] == <span class="number">0</span>) &#123;</span><br><span class="line">      q.<span class="built_in">push</span>(i);</span><br><span class="line">      ans[i] = <span class="number">0</span>;</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">while</span> (!q.<span class="built_in">empty</span>()) &#123;</span><br><span class="line">    <span class="keyword">int</span> x = q.<span class="built_in">front</span>(); q.<span class="built_in">pop</span>();</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> to : G[x]) &#123;</span><br><span class="line">      du[to] --;</span><br><span class="line">      <span class="keyword">if</span> (du[to] &lt;= <span class="number">0</span>) &#123;</span><br><span class="line">        ans[to] = ans[x] + <span class="number">1</span>;</span><br><span class="line">        q.<span class="built_in">push</span>(to);</span><br><span class="line">      &#125;</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span>; i &lt;= n; i++) &#123;</span><br><span class="line">    <span class="built_in">printf</span>(<span class="string">&quot;%d\n&quot;</span>, ans[i] / <span class="number">2</span>);</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
      
    </div>

    
    
    
      <footer class="post-footer">
        <div class="post-eof"></div>
      </footer>
  </article>
  
  
  

      
  
  
  <article itemscope itemtype="http://schema.org/Article" class="post-block" lang="zh-CN">
    <link itemprop="mainEntityOfPage" href="http://example.com/2021/10/23/%E6%8A%80%E6%9C%AF%E7%9B%B8%E5%85%B3/LIBPNG%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/avatar.gif">
      <meta itemprop="name" content="dxyinme">
      <meta itemprop="description" content="可怜人的自我救赎">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="dxy的耻辱柱">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          
            <a href="/2021/10/23/%E6%8A%80%E6%9C%AF%E7%9B%B8%E5%85%B3/LIBPNG%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/" class="post-title-link" itemprop="url">LIBPNG学习笔记</a>
        </h2>

        <div class="post-meta">
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-calendar"></i>
              </span>
              <span class="post-meta-item-text">发表于</span>

              <time title="创建时间：2021-10-23 15:20:39" itemprop="dateCreated datePublished" datetime="2021-10-23T15:20:39+08:00">2021-10-23</time>
            </span>
              <span class="post-meta-item">
                <span class="post-meta-item-icon">
                  <i class="far fa-calendar-check"></i>
                </span>
                <span class="post-meta-item-text">更新于</span>
                <time title="修改时间：2021-11-06 11:48:21" itemprop="dateModified" datetime="2021-11-06T11:48:21+08:00">2021-11-06</time>
              </span>

          

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">

      
          <h2 id="写在前面"><a href="#写在前面" class="headerlink" title="写在前面"></a>写在前面</h2><p>一些libpng相关的内容</p>
<h2 id="一些用到的库"><a href="#一些用到的库" class="headerlink" title="一些用到的库"></a>一些用到的库</h2><h3 id="安装PIL"><a href="#安装PIL" class="headerlink" title="安装PIL"></a>安装PIL</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">sudo apt-get install python3-pip</span><br><span class="line">pip3 install pillow -i https://mirrors.aliyun.com/pypi/simple/</span><br></pre></td></tr></table></figure>
<h3 id="libpng安装和使用"><a href="#libpng安装和使用" class="headerlink" title="libpng安装和使用"></a>libpng安装和使用</h3><p>下载地址 <a target="_blank" rel="noopener" href="https://sourceforge.net/projects/libpng/files/">https://sourceforge.net/projects/libpng/files/</a><br>解压之后</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">./configure</span><br><span class="line">make check</span><br><span class="line">sudo make install</span><br></pre></td></tr></table></figure>
<p>libpng好像还需要依赖zlib</p>
<p>zlib 走这个下载 <a target="_blank" rel="noopener" href="https://zlib.net/">https://zlib.net/</a><br>然后基本也是跟libpng一样的安装方式。</p>
<p>就装好了，要用的话就在cmake链接里面加一下就行</p>
<figure class="highlight cmake"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">cmake_minimum_required</span>(VERSION <span class="number">3.1</span>)</span><br><span class="line"><span class="keyword">project</span>(uxpng)</span><br><span class="line"><span class="keyword">set</span>(CMAKE_CXX_STANDARD <span class="number">14</span>)</span><br><span class="line"><span class="keyword">add_executable</span>(uxpng main.cpp)</span><br><span class="line"><span class="keyword">target_link_libraries</span>(uxpng png)</span><br></pre></td></tr></table></figure>

<h2 id="jpg2png"><a href="#jpg2png" class="headerlink" title="jpg2png"></a>jpg2png</h2><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># coding: utf-8</span></span><br><span class="line"><span class="comment"># python3</span></span><br><span class="line"><span class="keyword">from</span> PIL <span class="keyword">import</span> Image</span><br><span class="line"><span class="keyword">import</span> sys</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> __name__ == <span class="string">&#x27;__main__&#x27;</span> :</span><br><span class="line">	pg = <span class="string">&#x27;&#123;&#125;.jpg&#x27;</span>.<span class="built_in">format</span>(sys.argv[<span class="number">1</span>])</span><br><span class="line">	img = Image.<span class="built_in">open</span>(pg)</span><br><span class="line">	img.save(<span class="string">&#x27;&#123;&#125;.png&#x27;</span>.<span class="built_in">format</span>(sys.argv[<span class="number">1</span>]))</span><br><span class="line"></span><br></pre></td></tr></table></figure>
<p>这是一个把jpg文件转换成png文件的脚本，为啥要这样呢，主要是因为这里主要是在用libpng玩东西，所以有了这么个脚本</p>
<h2 id="PNG基础"><a href="#PNG基础" class="headerlink" title="PNG基础"></a>PNG基础</h2><p><a target="_blank" rel="noopener" href="https://gitee.com/dxyinme/uxpng">https://gitee.com/dxyinme/uxpng</a> 这里是我学习libpng相关的一些操作和实践</p>
<h3 id="图像类型"><a href="#图像类型" class="headerlink" title="图像类型"></a>图像类型</h3><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//摘抄自libpng的定义</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> PNG_COLOR_MASK_PALETTE    1</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> PNG_COLOR_MASK_COLOR      2</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> PNG_COLOR_MASK_ALPHA      4</span></span><br><span class="line"></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> PNG_COLOR_TYPE_GRAY 0   <span class="comment">// 灰度图</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> PNG_COLOR_TYPE_PALETTE  (PNG_COLOR_MASK_COLOR | PNG_COLOR_MASK_PALETTE) <span class="comment">// 调色板（我也不知道啥玩意儿）</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> PNG_COLOR_TYPE_RGB        (PNG_COLOR_MASK_COLOR) <span class="comment">// RGB图</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> PNG_COLOR_TYPE_RGB_ALPHA  (PNG_COLOR_MASK_COLOR | PNG_COLOR_MASK_ALPHA) <span class="comment">// RGB+透明度图</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> PNG_COLOR_TYPE_GRAY_ALPHA (PNG_COLOR_MASK_ALPHA) <span class="comment">// 灰度+透明度图</span></span></span><br></pre></td></tr></table></figure>
<p>先不考虑调色板的话，PNG一共有4种格式。抛开固定格式，整个图的存储方式大致是一个二维的矩阵，矩阵的每个元素可以被看成是一个像素, 每个像素按照自己的图像类型，以某些特定的方式排列。例如RGB类型的图像，他的排列方式就是</p>
<figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">|B|G|R| <span class="comment">// 通道数为3</span></span><br></pre></td></tr></table></figure>
<p>如果是RGB-alpha(有透明通道)的图像，他的排序方式就是</p>
<figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">B|G|R|A| <span class="comment">// 通道数为4</span></span><br></pre></td></tr></table></figure>
<p>灰度图和灰度透明图只有一个（两个）通道，用来表示每个像素的灰度和透明度。</p>
<h2 id="图像的读写"><a href="#图像的读写" class="headerlink" title="图像的读写"></a>图像的读写</h2><h3 id="读取png图像"><a href="#读取png图像" class="headerlink" title="读取png图像"></a>读取png图像</h3><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">fp = <span class="built_in">fopen</span>(img_path, <span class="string">&quot;rb&quot;</span>); <span class="comment">// 打开文件</span></span><br><span class="line">png_ptr  = <span class="built_in">png_create_read_struct</span>(PNG_LIBPNG_VER_STRING, <span class="literal">nullptr</span>, <span class="literal">nullptr</span>, <span class="literal">nullptr</span>); <span class="comment">// 初始化png读指针</span></span><br><span class="line">info_ptr = <span class="built_in">png_create_info_struct</span>(png_ptr); <span class="comment">// 初始化内容指针</span></span><br><span class="line"><span class="built_in">png_init_io</span>(png_ptr, fp); <span class="comment">// 初始化io指针</span></span><br><span class="line"><span class="built_in">png_read_png</span>(png_ptr, info_ptr, PNG_TRANSFORM_EXPAND, <span class="literal">nullptr</span>); <span class="comment">// 读取png</span></span><br></pre></td></tr></table></figure>
<p>首先，先获取图像的基本信息</p>
<figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">int</span> channels, color_type, bit_depth, width, height;</span><br><span class="line">channels = <span class="built_in">png_get_channels</span>(png_ptr, info_ptr);</span><br><span class="line">color_type = <span class="built_in">png_get_color_type</span>(png_ptr, info_ptr);</span><br><span class="line">bit_depth = <span class="built_in">png_get_bit_depth</span>(png_ptr, info_ptr);</span><br><span class="line">width = <span class="built_in">png_get_image_width</span>(png_ptr, info_ptr);</span><br><span class="line">height  = <span class="built_in">png_get_image_height</span>(png_ptr, info_ptr);</span><br></pre></td></tr></table></figure>
<p>其次再获取整个图像矩阵</p>
<figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">auto</span> row_pointers = <span class="built_in">png_get_rows</span>(png_ptr, info_ptr);</span><br></pre></td></tr></table></figure>
<p>这里的图像矩阵的高是height，宽是 channels * width 读取像素的时候需要获取连续channels个元素。</p>
<h3 id="输出png图像"><a href="#输出png图像" class="headerlink" title="输出png图像"></a>输出png图像</h3><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">png_ptr = <span class="built_in">png_create_write_struct</span>(PNG_LIBPNG_VER_STRING, <span class="literal">nullptr</span>, <span class="literal">nullptr</span>, <span class="literal">nullptr</span>); <span class="comment">// 这里要设置成write_struct</span></span><br><span class="line"><span class="built_in">png_init_io</span>(png_ptr, fp);</span><br><span class="line"><span class="built_in">png_set_IHDR</span>(png_ptr, info_ptr,</span><br><span class="line">	png_data-&gt;<span class="built_in">Width</span>(), png_data-&gt;<span class="built_in">Height</span>(), png_data-&gt;<span class="built_in">BitDepth</span>(), </span><br><span class="line">	png_data-&gt;<span class="built_in">ColorType</span>(),</span><br><span class="line">	PNG_INTERLACE_NONE, PNG_COMPRESSION_TYPE_BASE, PNG_FILTER_TYPE_BASE);</span><br><span class="line"><span class="built_in">png_write_info</span>(png_ptr, info_ptr);</span><br><span class="line"><span class="comment">// 先写入图像基本信息</span></span><br></pre></td></tr></table></figure>
<p>按行写入图像的某个图像行,这个是按顺序的，调用一次，下一次写的行数+1。</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">png_write_row(png_ptr, row_ptr);</span><br></pre></td></tr></table></figure>
      
    </div>

    
    
    
      <footer class="post-footer">
        <div class="post-eof"></div>
      </footer>
  </article>
  
  
  

      
  
  
  <article itemscope itemtype="http://schema.org/Article" class="post-block" lang="zh-CN">
    <link itemprop="mainEntityOfPage" href="http://example.com/2021/10/07/%E6%8A%80%E6%9C%AF%E7%9B%B8%E5%85%B3/%E6%8E%92%E5%BA%8F%E7%9B%B8%E5%85%B3%E7%9A%84%E4%BA%8C%E4%B8%89%E4%BA%8B/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/avatar.gif">
      <meta itemprop="name" content="dxyinme">
      <meta itemprop="description" content="可怜人的自我救赎">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="dxy的耻辱柱">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          
            <a href="/2021/10/07/%E6%8A%80%E6%9C%AF%E7%9B%B8%E5%85%B3/%E6%8E%92%E5%BA%8F%E7%9B%B8%E5%85%B3%E7%9A%84%E4%BA%8C%E4%B8%89%E4%BA%8B/" class="post-title-link" itemprop="url">排序相关的二三事</a>
        </h2>

        <div class="post-meta">
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-calendar"></i>
              </span>
              <span class="post-meta-item-text">发表于</span>
              

              <time title="创建时间：2021-10-07 13:58:01 / 修改时间：20:33:38" itemprop="dateCreated datePublished" datetime="2021-10-07T13:58:01+08:00">2021-10-07</time>
            </span>

          

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">

      
          <h2 id="写在前面"><a href="#写在前面" class="headerlink" title="写在前面"></a>写在前面</h2><p>国庆在家里实在是无聊透顶，在写算法题的时候发现一个事情，c++的std::sort是不支持链式数据结构的，所以就想着能不能做一个给单向链表排序的排序算法。所有相关代码被放在 <a target="_blank" rel="noopener" href="https://gitee.com/dxyinme/Vsort">GITEE:dxyinme/Vsort</a></p>
<h2 id="具体要怎么做"><a href="#具体要怎么做" class="headerlink" title="具体要怎么做"></a>具体要怎么做</h2><p>我们先设计了一个单链表结构<code>VListNode</code>如下：</p>
<figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">template</span>&lt;<span class="keyword">typename</span> T&gt;</span><br><span class="line"><span class="class"><span class="keyword">struct</span> <span class="title">VListNode</span> &#123;</span></span><br><span class="line">  T val;</span><br><span class="line">  VListNode *nxt;</span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure>
<p>如果我们要合并两个有序的单链表，那么我们就只需要每次选择一个链表里面最大的元素就可以。这个很简单，详见 <a target="_blank" rel="noopener" href="https://gitee.com/dxyinme/Vsort/blob/master/v_sort_list.h#L59">Vsort::MergeList</a>，可以合并两个有序单向链表的话，我们就可以做一个归并排序，每次<code>O(n)</code>选取整个链表的中点，将整个链表从中点切成两个链表，切完之后，递归继续，直到只剩下一个元素为止。</p>
<p>我们对于</p>
<h2 id="优化"><a href="#优化" class="headerlink" title="优化"></a>优化</h2><p>单只有链表排序肯定不够，而且性能也普通的std::sort对vector排序比差了不少，是否可以进行一个多线程的优化。<br>整个多线程排序分成三个部分：</p>
<ol>
<li>我们将整个待排序容器切成若干部分 (同步)</li>
<li>每个部分排序 (异步)</li>
<li>合并每个已经排序的部分 (异步)</li>
</ol>

      
    </div>

    
    
    
      <footer class="post-footer">
        <div class="post-eof"></div>
      </footer>
  </article>
  
  
  

      
  
  
  <article itemscope itemtype="http://schema.org/Article" class="post-block" lang="zh-CN">
    <link itemprop="mainEntityOfPage" href="http://example.com/2020/09/12/%E6%96%87/%E6%9A%97%E9%9D%A2%E5%9F%8E%E5%B8%82%E7%B3%BB%E5%88%97/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/avatar.gif">
      <meta itemprop="name" content="dxyinme">
      <meta itemprop="description" content="可怜人的自我救赎">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="dxy的耻辱柱">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          
            <a href="/2020/09/12/%E6%96%87/%E6%9A%97%E9%9D%A2%E5%9F%8E%E5%B8%82%E7%B3%BB%E5%88%97/" class="post-title-link" itemprop="url">暗面城市系列</a>
        </h2>

        <div class="post-meta">
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-calendar"></i>
              </span>
              <span class="post-meta-item-text">发表于</span>

              <time title="创建时间：2020-09-12 16:49:51" itemprop="dateCreated datePublished" datetime="2020-09-12T16:49:51+08:00">2020-09-12</time>
            </span>
              <span class="post-meta-item">
                <span class="post-meta-item-icon">
                  <i class="far fa-calendar-check"></i>
                </span>
                <span class="post-meta-item-text">更新于</span>
                <time title="修改时间：2021-08-15 20:13:47" itemprop="dateModified" datetime="2021-08-15T20:13:47+08:00">2021-08-15</time>
              </span>

          

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">

      
          <h3>暗面城市系列</h3>
来到不一样的城市之后，大家都会有一种不习惯，
这种不习惯越来越严重之后是否会变成这样呢？


<p><strong>1</strong></p>
<pre><code>和其他时候不一样，在这个冰冷的城市也还是会有比较热的几天的。就算是这几天的炎热，在晚上的时候也会消失殆尽。
没有蝉鸣，没有长时间的热风，只有植物在疯狂地生长扩张。
“在这种夜晚憧憬着柔软冰凉的东西的我一定是疯了吧...... ”，我这样想着。
“你就是他们所提到的那个人吗？”
身后的声音貌似在验证我的身份，而且，那种声音仿佛在期待着否定的答案。
“不是，我只是个普通的过路人而已。”，我这样回答。虽然我也不知道他们所提到的那个人是谁，但这对我一个赶路人来说，并不重要。
“你还记得我吗？我是你去H市之前见过的那个。”
“前几个月的时候你还没这么瘦啊。”
“诶诶诶你不会吧我忘了吧......”
“这个女人在自说自话什么啊？”，我这样想着，转过身说，“对不起我们不认识......”
“.......吧？”
显然是想收回刚刚的话，毕竟被眼前熟悉的面孔惊诧到了。
“喔，你不认得我啦？”
她渐渐靠近， “那我也要好好确认一下是不是你哦。”
她的手和脸靠了上来。
冰冷的手，我闭上了眼睛。
</code></pre>
<p><img src="https://dxyinme.github.io/images/kiss.jpg" alt="arvatar"></p>
<p><strong>2</strong></p>
<pre><code>一次有人跟我说这里的住民有一些冷漠，但我还是依旧选择来到这个城市。
路上没有行人，偶尔路过的是一种带着翅膀的阴影。无法形容他们的样貌，大概跟所谓的“人”很相似吧。
当黎明到来的时候，这里的原住民会褪下翅膀，变为一些长着四肢和眼睛的生物。
身后有一个原住民对我说话，“你知道春天已经来了么？”。
清晨的第一缕阳光照射在他脸上，一半暗淡，一半明亮。
“我知道。”，我回答。
太阳升起。
“那就把冬天的记忆留在这里献给春天吧。”
雾气弥漫开来。
我转过身面对着他。
</code></pre>
<p><img src="https://dxyinme.github.io/images/spring.jpg" alt="arvatar"></p>
<p><strong>3</strong></p>
<pre><code>这里的夜很长。
夕阳落下的时候，那种长夜之前的平静，正是那个男人乐于欣赏的。
可惜今天下着雨，并不是晴天。
这是A城这个月最后一个白天。周围的路上没有人，大概要到夜晚才会出来活动吧。
他的腋下夹着一副画，用厚厚的帆布包裹着。
“带着温热触感的阳光什么时候才能照在我身上呢？”，他摇了摇头。
天完全暗了下去，蓝白色的街上只有他瘦长的背影。
雨停了，月光撕开了云层。“白天”开始了。
</code></pre>
<p><img src="https://dxyinme.github.io/images/summer.jpg" alt="arvatar"></p>
<p><strong>4</strong></p>
<pre><code>这里的太阳没有一点温度，甚至还在剥离着我身上的能量。
夏天是最不好受的，待在屋子里还暖和些，出门简直要被冻死。
当时间进入十一月份，你可以看见街道上的人正在渐渐变得有活力起来，
夜晚的灯光也比之前夏天的时候更柔和些。
“你们在准备什么？”，我叫住了一个原住民，他手上拿着积满灰尘的模具，向一个广场走着。
“你过来看看吧，外乡人。”
我跟随着他走向广场，身边的人越来越多，
他们手上或是拿着模具，或是拿着各种容器，彼此交谈着什么。
我看着他们把篮子，箱子，木桶放在地上。不一会儿，
乌云中洒落下稀稀拉拉的光点，接着越来越大，填满了所有的容器，我仿佛在原住民的脸上看到了许久不见的笑容。
“这就是感恩节，小伙子。”，刚刚的原住民拍了拍我，“这是他们欠我们的。”
</code></pre>
<p><img src="https://dxyinme.github.io/images/autumn.jpg" alt="arvatar"></p>

      
    </div>

    
    
    
      <footer class="post-footer">
        <div class="post-eof"></div>
      </footer>
  </article>
  
  
  

      
  
  
  <article itemscope itemtype="http://schema.org/Article" class="post-block" lang="zh-CN">
    <link itemprop="mainEntityOfPage" href="http://example.com/2020/09/12/%E6%96%87/%E6%9F%90%E4%BA%BA%E7%9A%84%E7%88%B1%E6%83%85%E6%95%85%E4%BA%8B%E7%B3%BB%E5%88%97/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/avatar.gif">
      <meta itemprop="name" content="dxyinme">
      <meta itemprop="description" content="可怜人的自我救赎">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="dxy的耻辱柱">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          
            <a href="/2020/09/12/%E6%96%87/%E6%9F%90%E4%BA%BA%E7%9A%84%E7%88%B1%E6%83%85%E6%95%85%E4%BA%8B%E7%B3%BB%E5%88%97/" class="post-title-link" itemprop="url">某人的爱情故事系列</a>
        </h2>

        <div class="post-meta">
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-calendar"></i>
              </span>
              <span class="post-meta-item-text">发表于</span>

              <time title="创建时间：2020-09-12 16:49:11" itemprop="dateCreated datePublished" datetime="2020-09-12T16:49:11+08:00">2020-09-12</time>
            </span>
              <span class="post-meta-item">
                <span class="post-meta-item-icon">
                  <i class="far fa-calendar-check"></i>
                </span>
                <span class="post-meta-item-text">更新于</span>
                <time title="修改时间：2021-08-15 20:13:47" itemprop="dateModified" datetime="2021-08-15T20:13:47+08:00">2021-08-15</time>
              </span>

          

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">

      
          <h3>某人的爱情故事系列</h3>
应某人的要求，给他创作一个爱情故事。


<p><strong>1</strong></p>
<pre><code>这家咖啡馆我常来，但是作为一个对味道不太灵敏的人，我对咖啡不太感冒。
不过这里宁静的气氛，不失为一个观察情侣约会的好场所。
右前桌的两个女孩子热烈地讨论着什么。
“下次这么做的时候，要记得反复检查。”
怎么听起来像是上司和下属的对话。
“嗯啊知道了，我会注意的。”，长发女孩点了点头。胸口蓝宝石项链反射出的光吸引了我的眼睛。
我嘬了一口咖啡，果然还是一如既往的苦，不过发现了工作目标，今天说不定可以吃顿好的。
“不要放过任何一个机会啊。”，那位短发女孩又开始用训诫的口气讲话了，“我都想亲身示范给你看了。”
“那就那个如何？”，长发女孩指向了我这边。
“示范什么？”，我正纳闷着。
“先生，请问您现在有空吗？”，那位短发女孩转过了头，“要不要过来聊聊天，我们正缺话题呢。”
</code></pre>
<p><img src="https://dxyinme.github.io/images/coffee.jpg" alt="arvatar"></p>
<p><strong>2</strong></p>
<pre><code>前段时间在咖啡馆遇到的女孩是和我同一个学校的，
我最近经常在图书室遇见她，有一搭没一搭地聊着，却也继续逐渐熟络起来。
“你会喜欢夏天吗？”，她忽然抛出这样的问题，“最近越来越热了呢。”
“我感觉一般般，不讨厌吧。”
她眯着的眼睛仿佛要把我看穿，不，可能已经看穿了。
“话说，”，我一直对那天的事情耿耿于怀，“我这种人应该不是很讨女孩子喜欢吧。”
“我觉得你挺有趣的呀，至少不讨厌。”，眯眯眼同学貌似依旧在入侵我的思维。
“不过跟踪这种行为，我可不喜欢你对别人做。”
</code></pre>
<p><img src="https://dxyinme.github.io/images/stand_single.jpg" alt="arvatar"></p>
<p><strong>3</strong></p>
<pre><code>“天天跟着我不会觉得无聊嘛？”，我将疑问抛给身边的少女，“我觉得你的跟踪行为已经影响到我了。”
“我看你每天也就逛逛街看看书，时不时看看手机，也没啥见不得人的嘛。”
我觉得她也不想正面回答。
已经有段时间没有收入了，之前的积蓄虽还余裕，
但老是吃存款也不是办法。毕竟身边有个人形自走监控器，干起活来确实不方便。
“我说啊，这大概是所谓的，&#39;殊途同归&#39;？”
她将面前的酒一饮而尽，“现在我们啊，可在同一条路上呢。”
她像小鹿一样撞进我的怀里，“现在，你可跑不掉。”
</code></pre>
<p><img src="https://dxyinme.github.io/images/hug.jpg" alt="arvatar"></p>
<p><strong>4</strong></p>
<pre><code>我希望你能够冷静客观地对待这件事情。”
“不行，我无法接受，你请回吧！”，
她的眼神里带着几分困惑和悲伤，却还要装作一副潇洒的样子，“你不走，我走！”
女孩后退了几步，转身要离去，
那个男人却拉住她的手，“你扰乱了我的生活，在你离开之前，希望你做出对应的补偿。”
“你在说这个吗？”，她掏出手机，一遍遍地翻着之前的她和他的照片，“这个，这个还有这个！？”
“啪。”，女孩把手机砸在地上。
“这是我们第一次见面时候的照片，你看到了吗！？”，
豆大的泪水滚落下来，“你想要的话，就把这些都带走吧！”
</code></pre>
<p><img src="https://dxyinme.github.io/images/phone.jpg" alt="arvatar"><br><img src="https://dxyinme.github.io/images/honey.jpg" alt="arvatar"></p>
<p><strong>5</strong></p>
<pre><code>“你猜今天我准备带你去哪儿？”
“还能是哪儿？”，她一脸轻蔑的望着我，“老三样，食堂机房图书馆。像你这样的人有什么好猜测的。”
真的是越来越毒舌了，她以前还不这样的。
“很可惜你猜错啦。” ，我摸摸她的头，“今天可是国庆节。是特殊的日子。”
…
我拉起她的手跑了起来，看起来她挺不情愿的。
“你是否还记得这个咖啡店呢。”
“咋啦，这不就是普通的一家咖啡店嘛。”
“不，这不一样。”
“对我来说，今天确实不一样。”，我对着她疑惑的脸慢慢说道。
“但是今天的你，和那天一样。”
</code></pre>
<p><img src="https://dxyinme.github.io/images/stand.jpg" alt="arvatar"></p>

      
    </div>

    
    
    
      <footer class="post-footer">
        <div class="post-eof"></div>
      </footer>
  </article>
  
  
  

      
  
  
  <article itemscope itemtype="http://schema.org/Article" class="post-block" lang="zh-CN">
    <link itemprop="mainEntityOfPage" href="http://example.com/2020/09/12/%E6%96%87/%E5%BA%9F%E5%BC%83%E9%83%BD%E5%B8%82%E7%95%AA%E5%A4%96/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/avatar.gif">
      <meta itemprop="name" content="dxyinme">
      <meta itemprop="description" content="可怜人的自我救赎">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="dxy的耻辱柱">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          
            <a href="/2020/09/12/%E6%96%87/%E5%BA%9F%E5%BC%83%E9%83%BD%E5%B8%82%E7%95%AA%E5%A4%96/" class="post-title-link" itemprop="url">废弃都市番外</a>
        </h2>

        <div class="post-meta">
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-calendar"></i>
              </span>
              <span class="post-meta-item-text">发表于</span>

              <time title="创建时间：2020-09-12 15:16:14" itemprop="dateCreated datePublished" datetime="2020-09-12T15:16:14+08:00">2020-09-12</time>
            </span>
              <span class="post-meta-item">
                <span class="post-meta-item-icon">
                  <i class="far fa-calendar-check"></i>
                </span>
                <span class="post-meta-item-text">更新于</span>
                <time title="修改时间：2021-08-15 20:13:47" itemprop="dateModified" datetime="2021-08-15T20:13:47+08:00">2021-08-15</time>
              </span>

          

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">

      
          <h3>废弃都市番外</h3>
发生在废弃都市的番外故事，希望大家喜欢。


<p><strong>1</strong></p>
<pre><code>“这里......好冷.......”
他们说这家医院有一种让人说不出的阴森感，空无一人的招待台，不知道多久前的X光片，都映衬着凋零的气息。
“能帮我找个镜子来吗？我想看看手术后恢复的怎么样。”，她轻轻地说，惨白的病号服和脸上的绷带后面的棕色瞳孔形成鲜明的对比。
......
“给。”
她接过镜子，慢慢解开绷带。
“啊，恢复的还不错。”
“这位先生，”，她继续端详着镜子里的自己，“你会有好运气的。”
苍白的脸上带着一丝笑容。
只是这个笑容，在镜子里看不见。
</code></pre>
<p><strong>2</strong></p>
<pre><code>在后街的下水道旁，有一个穿着破旧运动服的胡子拉碴的男人。
如果不仔细观察的话，可能会觉得他是个流浪汉。但他其实在我刚到这个城市的时候帮助了我很多。
在找到一份糊口的工作之后，我多次想要报答他，却都被他拒绝了。
这天我经过他面前的时候，照例问他是否要一起去吃一顿。他忽然站了起来。
“如果你真的想帮我的话。”，他缓缓地说，“那就把这束花送给医院前的那个女人吧。”
说罢，他从身后掏出一束玫瑰。
我点点头，拿上玫瑰走了。虽然那个阴森的医院给人的感觉不大好，但如果是他的嘱托，我还是很乐意去做的。
“这是吉姆托我给你带的玫瑰。”，我将玫瑰放到少女的手上。
她没有说什么，只是低头静静地看着。
“谢谢你。”
今天是情人节，我走在回家的路上，远处的晚霞宣告着明日的艳阳天。
在这个城市里，很多人在为了这平静的日常默默付出。
“观察者的日子可真难过。”，我轻轻地说。
</code></pre>
<p><strong>3</strong></p>
<pre><code>空无一人的车厢。
已经不知道这个地铁的建造时间要推到多少年前了，不过它锈迹斑驳的扶手和昏暗的灯光也告诉着大家它的年龄不小。
玻璃和车厢壁上都是暗色的污渍，为此我还仔细跟管理员讲过这事情，但懒散的他估计也不会认真去管我这种新面孔的要求吧。
“前方到站是----B1站”
这报站铃的声音倒是还挺大。
门吱吱嘎嘎的开了，走上来了一个披着风衣的瘦小身影。坐在门斜对面的我，貌似看见门的站台有什么东西在飘动着。
“你身边有人吗？”，是个很轻的女声，我仿佛在哪儿听到过。
“没有，坐这吧。”
她身上的风衣明显不合身，而且很新，却带着腐朽的气味。她将手上的袋子放在腿上，里面是一些药和本子之类的东西。
“吃一个糖吧。”，她从风衣口袋里摸出一个水果软糖递给我。
我接过来，把糖塞进口袋里。她全程偏着头看着，也没有说什么。垂下的头发遮住了她的脸颊。我忽然想起来了，她是在医院里的那个女人。
“你知道吗，上次你给我的镜子，我还一直带在身边喔。”，她默默地说，“上次不小心吓坏你了吧，但是没有办法，这个病就是这样，你看我不是来复查了嘛。”
脱下帽子的她努力向我挤出一个阳光的笑容。
“前方到站是----城中站。”
“我要下车了，下次再见。”，我跟身边的女人挥了挥手，走出了车厢。
此时的站台上站着许多人，杂乱无章的脚步声渐渐盖住了这个城市的黄昏。
“我也是这里下。”，柔弱却具有穿透力的声音从身后传来，“先生，你走的太急了，这是你的工作证。”
我急忙接过工作证向她道谢。
“是医院边上那家呢，我一会儿会过去照顾生意的哟。”，她笑着说。
“以后还有机会见到你吗？”
“有机会的喔，我会常来城里。”
听到这里，曾经的恐惧和不安已经消失，逆着人群前行的两人也渐渐熟悉了起来。
</code></pre>
<p><strong>4</strong></p>
<pre><code>如果说有什么不合时宜的事情，那估计就是开春之后的大雨吧。周围行人廖廖，时不时有人顶着包匆匆跑过。
“我曾经很喜欢雨天的。”，我在心里咒骂到，“现在这种天气可真见鬼。”
但是无论如何都动弹不得，手臂上的伤口，外衣被雨水浸透，头也一阵一阵地疼。
“起来吧，拉着我。”
用比周遭环境要阴沉十倍的声音说出关心的话，还真只有这个人能做到。
我忽然想笑一笑来展现我的感谢，但是稍微活动一下面部肌肉就伴随着难忍的酸痛。
迟疑间，她抓住了我的手，一把把我拉了起来。
冰冷的手，但却充满温暖。
可能某种程度上，我还是喜欢雨天的吧。
</code></pre>
<p><img src="https://dxyinme.github.io/images/hand_in_rain.jpg" alt="arvatar"></p>
<p><strong>5</strong><br>    “啊，有些事情忘掉了。”，坐在去往火车站的地铁上，我忽然发出了这样的感慨。<br>    “算了吧，其实也跟我没什么太大关系，”<br>    “或者说，总要跟我扯不上关系的。”<br>    窗外漆黑一片，从斑驳的玻璃上仿佛可以清晰地看见自己的面容，<br>    “如果没有额头上缠着的纱布，也许就能完美融入周围的人了吧。”我这样想着。<br>    “前方到站，B1站”<br>    熟悉的报站声音响起。<br>    “前段时间他们修好了地铁的报站广播，现在没有以前那么刺耳了……”<br>    “就是就是，好好翻新一下地铁还是挺好的嘛……”<br>    “你们以前那么讨厌地铁，现在反倒还喜欢起来了……”<br>    几句清脆的评论也算是对老地铁翻新工作做出的肯定吧。<br>    轻快的脚步声停止在我的面前。<br>    “熟悉的声音。”，我咕哝着。<br>    “这位先生，你要离开这里了是吗？”<br>    这么有朝气的声音，几个月前你可还是个病号啊。我努力把自己的吐槽压回肚子里，“是的。”<br>    “那好，祝你一切顺利。还有，”，她说，<br>    “谢谢你。”<br>    “前方到站，火车站。”<br>    我提上沉重的行李走下了地铁。<br>    她对我笑着，就仿佛我没有离开一样。</p>
<p><img src="https://dxyinme.github.io/images/lovely.jpg" alt="arvatar"></p>

      
    </div>

    
    
    
      <footer class="post-footer">
        <div class="post-eof"></div>
      </footer>
  </article>
  
  
  

      
  
  
  <article itemscope itemtype="http://schema.org/Article" class="post-block" lang="zh-CN">
    <link itemprop="mainEntityOfPage" href="http://example.com/2020/09/12/%E6%96%87/%E7%BC%B8%E4%B8%AD%E4%B9%8B%E8%84%91%E7%B3%BB%E5%88%97/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/avatar.gif">
      <meta itemprop="name" content="dxyinme">
      <meta itemprop="description" content="可怜人的自我救赎">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="dxy的耻辱柱">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          
            <a href="/2020/09/12/%E6%96%87/%E7%BC%B8%E4%B8%AD%E4%B9%8B%E8%84%91%E7%B3%BB%E5%88%97/" class="post-title-link" itemprop="url">缸中之脑系列</a>
        </h2>

        <div class="post-meta">
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-calendar"></i>
              </span>
              <span class="post-meta-item-text">发表于</span>

              <time title="创建时间：2020-09-12 12:59:13" itemprop="dateCreated datePublished" datetime="2020-09-12T12:59:13+08:00">2020-09-12</time>
            </span>
              <span class="post-meta-item">
                <span class="post-meta-item-icon">
                  <i class="far fa-calendar-check"></i>
                </span>
                <span class="post-meta-item-text">更新于</span>
                <time title="修改时间：2021-08-15 20:13:47" itemprop="dateModified" datetime="2021-08-15T20:13:47+08:00">2021-08-15</time>
              </span>

          

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">

      
          <h3>缸中之脑系列</h3>
讲述了一个又一个痛苦的轮回的故事，有些故事已经记不清了，就从这个开始吧。

<p><strong>1</strong></p>
<pre><code>“要是有一天醒来发现之前的一切都是梦境怎么办？”
“你对梦境会感到害怕吗？”
“是有点，不过……”
“这么害怕梦境就离开吧。”
“但是……”
然而话没说完，另一个人就从楼上一跃而下，洒出的鲜血和夕阳一样，给地面染上了一抹妖艳的红。
</code></pre>
<p><strong>2</strong></p>
<pre><code>“我这是在哪儿？”
一个穿着白大褂的人指了指边上的一个培养缸，“欢迎离开缸中之脑实验。”
“所以过去的一切都是假的吗？”
没有回答，之前的白大褂就像凭空消失了一般。再看看周围，陌生。一缕不易察觉的月光照进实验室。
一个新的世界，开始了。
</code></pre>
<p><strong>3</strong></p>
<pre><code>“答应我，你一定要回来，一定要。”，她靠在他的肩上，用着一如往常的语气。
但是他没有说话，甚至连都没有转头看一下她，如果不是耳边呼呼地风声，他甚至以为这只是一次再正常不过的分离。然而他们却不可能再见面了。
“就算都是离开这个世界，但是去向的地方，还是不同呢。”，他心里想着，泪水不争气地涌了出来。
“不会让你离开我的。”他将怀中的女孩抱得更紧。
眼泪，飞快地向上飞去......
</code></pre>
<p><strong>4</strong></p>
<pre><code>一点一点，周围陷入沉默
一点一点，甚至连呼吸的声音都快要停止
男子低着头，嘴里默念着难懂的话语，周围星星点点的亮光也许并不能照亮所有的黑暗。但那却是宇宙中最闪亮的光芒啊。
终于，呼吸的声音也停止了，心脏的跳动也趋于平静，瞪大的眼睛仿佛在诉说着命运的不公，但那又能怎么样呢。
宇宙飞船越离越远，绝望散播在整个外太空。
</code></pre>
<p><strong>5</strong></p>
<pre><code>水流倒进肺里的痛苦一阵阵席卷全身，
睁眼，一片模糊。
这个男人下意识地掐住自己的喉咙。
“没用的，”，他的脑子里只有这句话，“很快就要被淹死了。”
刚刚苏醒就要被淹死。
一阵剧烈的咳嗽，水流到入肺里的速度更快了。
他的一生在他眼前闪过：月球、空间站、快速挥下的柴刀、脖颈骨折时清脆的声响、着地前发丝在脸上乱舞的最后一丝温暖......都已经不再存在了。
屏幕里的拟人图像不再挣扎，后面盛满绿色透明液体的水缸上的警报器乌拉乌拉地响着。失去生命体征的大脑如同几分钟前枪响后倒在地上的工作人员一样。
一阵敲门声，
这一切还没有结束。
</code></pre>
<p><strong>6</strong></p>
<pre><code>“才不会，你才不会回来。”
“......”
“你已经失踪很久了，不应该再出现的！”
“......”
“为什么，为什么又一次？为什么？”
男人歇斯底里地叫喊着，但是都没有得到回应。
“不想回到那个地方，求求你不要杀了我！让我在这里生活下去！求求你！”
“开心.....”，女子仿佛没有听到男人的哀求。
“你说什么？”
“好开心啊，又能送一个人回家了。”
她的嘴角微微上翘。
</code></pre>
<p><img src="https://dxyinme.github.io/images/knife.jpg" alt="arvatar"></p>
<p><strong>7</strong></p>
<pre><code>所以你最后还是死在了那个女人手里，是吗？”女孩笑着说，大胆华丽的衣着与首饰似乎与她并不是那么相衬。
“是的。”，男子点点头，哭丧着脸。
“诶诶诶不要一副很失落的表情嘛，那样子的世界还能有什么留恋吗？”
“这么说你没经历过也不会懂啊。”男子无奈地摊了摊手。
“在你们这些人眼中，我只是一个不谙世事的小毛孩而已。”女孩向酒招了招手，“酒保，再来一杯！”
“干了这杯酒，我想多听听你的故事，”，女孩说着抿了一口酒，然后递给男子，“你应该，不会介意吧。”
</code></pre>
<p><img src="https://dxyinme.github.io/images/wine.jpg" alt="arvatar"></p>
<p><strong>8</strong></p>
<pre><code>装着蓝色酒水的高脚杯，玫红色的耳饰。我知道她与她并不同，但经历了多次这种事情的我，并没有太大的惊讶。
“希望你不要继续沉沦下去。” ，她说，“已经很久很久了。”
“明明开始这个试验的是你们吧，凭什么让我回头！”，我一口喝掉面前的鸡尾酒，大声吼着，双手锤着吧台。
不断下落的意识，渐渐侵袭全身的凉意，耳边的音乐声慢慢模糊，我倒了下去。
“还有很多人你需要去拯救......”，她呷了一口酒，“那么，三年前再见，试验品先生。”
</code></pre>
<p><img src="https://dxyinme.github.io/images/single_drink.jpg" alt="arvatar"></p>
<p><strong>9</strong></p>
<pre><code>依旧是这个普通的夜晚，窗外的景色也如同三年前一般熟悉。沉默持续了很久，已经过了饭点了，所以店里并没有什么人。一男一女深情地对视着。
“如果现在我再提要求的话你会接受吗？”，男人身体前倾着，紧紧抓住女人的手。
“你还能有什么条件，一切尽管说吧。”她回答的语调轻松且愉快。
“这次我想做一次自己的选择。”，男人顿了顿，“请接受我的告白。”
这番调情和周围散乱的尸体和满地的血迹仿佛并没有什么联系，远处传来的警笛声渐渐支配了这个城市的夜晚。
</code></pre>
<p><img src="https://dxyinme.github.io/images/coup.jpg" alt="arvatar"></p>
<p><strong>10</strong></p>
<pre><code>“也许从头开始，我们走上的就是完全不同的两条道路。”
“也许从头开始，你把我带来就是个错误吧。”
“我也很想，很想追随你的步伐啊，但是说我根本不可能继承你的作用的也是你啊......”
“你错了，你根本不懂得压抑天性去追随你却被不断打击到的感受！”
“为什么啊？为什么要带我来啊？”
打开舱门，让自己的身体随着苦涩的海水慢慢的飘出去，目送着渐渐远离的小型潜艇，想去擦拭泪水的手碰到的却是防水面罩冰冷的外壳。
“一个满手鲜血的恶徒，凭什么得到你的同情呢？”
</code></pre>
<p><strong>11</strong></p>
<pre><code>todo
</code></pre>

      
    </div>

    
    
    
      <footer class="post-footer">
        <div class="post-eof"></div>
      </footer>
  </article>
  
  
  


  
  <nav class="pagination">
    <span class="page-number current">1</span><a class="page-number" href="/page/2/">2</a><a class="extend next" rel="next" href="/page/2/"><i class="fa fa-angle-right" aria-label="下一页"></i></a>
  </nav>



          </div>
          

<script>
  window.addEventListener('tabs:register', () => {
    let { activeClass } = CONFIG.comments;
    if (CONFIG.comments.storage) {
      activeClass = localStorage.getItem('comments_active') || activeClass;
    }
    if (activeClass) {
      let activeTab = document.querySelector(`a[href="#comment-${activeClass}"]`);
      if (activeTab) {
        activeTab.click();
      }
    }
  });
  if (CONFIG.comments.storage) {
    window.addEventListener('tabs:click', event => {
      if (!event.target.matches('.tabs-comment .tab-content .tab-pane')) return;
      let commentClass = event.target.classList[1];
      localStorage.setItem('comments_active', commentClass);
    });
  }
</script>

        </div>
          
  
  <div class="toggle sidebar-toggle">
    <span class="toggle-line toggle-line-first"></span>
    <span class="toggle-line toggle-line-middle"></span>
    <span class="toggle-line toggle-line-last"></span>
  </div>

  <aside class="sidebar">
    <div class="sidebar-inner">

      <ul class="sidebar-nav motion-element">
        <li class="sidebar-nav-toc">
          文章目录
        </li>
        <li class="sidebar-nav-overview">
          站点概览
        </li>
      </ul>

      <!--noindex-->
      <div class="post-toc-wrap sidebar-panel">
      </div>
      <!--/noindex-->

      <div class="site-overview-wrap sidebar-panel">
        <div class="site-author motion-element" itemprop="author" itemscope itemtype="http://schema.org/Person">
  <p class="site-author-name" itemprop="name">dxyinme</p>
  <div class="site-description" itemprop="description">可怜人的自我救赎</div>
</div>
<div class="site-state-wrap motion-element">
  <nav class="site-state">
      <div class="site-state-item site-state-posts">
          <a href="/archives/">
        
          <span class="site-state-item-count">14</span>
          <span class="site-state-item-name">日志</span>
        </a>
      </div>
      <div class="site-state-item site-state-tags">
        <span class="site-state-item-count">4</span>
        <span class="site-state-item-name">标签</span>
      </div>
  </nav>
</div>



      </div>

    </div>
  </aside>
  <div id="sidebar-dimmer"></div>


      </div>
    </main>

    <footer class="footer">
      <div class="footer-inner">
        

        

<div class="copyright">
  
  &copy; 
  <span itemprop="copyrightYear">2022</span>
  <span class="with-love">
    <i class="fa fa-heart"></i>
  </span>
  <span class="author" itemprop="copyrightHolder">dxyinme</span>
</div>
  <div class="powered-by">由 <a href="https://hexo.io/" class="theme-link" rel="noopener" target="_blank">Hexo</a> & <a href="https://muse.theme-next.org/" class="theme-link" rel="noopener" target="_blank">NexT.Muse</a> 强力驱动
  </div>

        








      </div>
    </footer>
  </div>

  
  <script src="/lib/anime.min.js"></script>
  <script src="/lib/velocity/velocity.min.js"></script>
  <script src="/lib/velocity/velocity.ui.min.js"></script>

<script src="/js/utils.js"></script>

<script src="/js/motion.js"></script>


<script src="/js/schemes/muse.js"></script>


<script src="/js/next-boot.js"></script>




  















  

  

</body>
</html>
